// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  // OJO: Si estás usando el archivo local "dev.db", cambia "postgresql" por "sqlite"
  provider = "postgresql" 
  url      = env("DATABASE_URL")
}

model Producto {
  id                 Int       @id @default(autoincrement())
  sku                String    @unique
  nombre             String
  precioFOB          Decimal
  gramaje            String?
  paisOrigen         String?
  cantidadPorCaja    Int       @default(0)
  cantidadPorDisplay Int       @default(0)
  moneda             String    @default("USD")
  duracion           String?
  
  // --- DATOS PARA CALCULADORA DE COMPRAS (MRP) ---
  ventaMensual       Int       @default(0) // Promedio calculado
  stockActual        Int       @default(0) // Inventario físico actual

  proveedorId        Int
  proveedor          Proveedor @relation(fields: [proveedorId], references: [id])
  
  // --- RELACIÓN CON HISTORIAL ---
  ventasHistoricas   VentaHistorica[]
}

model Proveedor {
  id        Int     @id @default(autoincrement())
  nombre    String
  pais      String
  ejecutivo String?
  email     String?
  telefono  String?
  
  direccion String?
  ciudad    String?
  website   String?
  notas     String?
  
  // --- DATOS LOGÍSTICOS ---
  leadTime  Int     @default(0) // Tiempo en días

  productos Producto[]
}

// --- NUEVO MODELO: HISTORIAL DE VENTAS ---
model VentaHistorica {
  id          Int      @id @default(autoincrement())
  fecha       DateTime
  cantidad    Int      
  
  productoId  Int
  producto    Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)
}