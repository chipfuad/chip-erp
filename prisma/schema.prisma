generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- MODELOS DE DATOS ---

model Producto {
  id                 Int      @id @default(autoincrement())
  sku                String   @unique
  nombre             String
  precioFOB          Decimal  @default(0)
  gramaje            String?
  paisOrigen         String?
  cantidadPorCaja    Int      @default(0)
  cantidadPorDisplay Int      @default(0)
  moneda             String   @default("USD")
  duracion           String?
  
  // --- DATOS PARA CALCULADORA LOGÍSTICA ---
  ventaMensual       Int      @default(0) // Promedio calculado
  stockActual        Int      @default(0) // Inventario físico actual
  
  // NUEVO: LeadTime específico por producto
  leadTime           Int      @default(0) 

  proveedorId        Int
  proveedor          Proveedor @relation(fields: [proveedorId], references: [id])
  
  // --- RELACIÓN CON HISTORIAL ---
  ventasHistoricas   VentaHistorica[]
}

model Proveedor {
  id        Int        @id @default(autoincrement())
  nombre    String
  pais      String?
  ejecutivo String?
  email     String?
  telefono  String?
  
  direccion String?
  ciudad    String?
  website   String?
  notas     String?
  
  // --- DATOS LOGÍSTICOS ---
  leadTime  Int        @default(0) // Tiempo en días general

  productos Producto[]
}

// --- HISTORIAL DE VENTAS ---
model VentaHistorica {
  id         Int      @id @default(autoincrement())
  fecha      DateTime
  cantidad   Int      
  
  productoId Int
  producto   Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)

  // CANDADO ANTI-DUPLICADOS (Vital para la importación)
  @@unique([productoId, fecha])
}